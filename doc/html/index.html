<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.4"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>TaskManager: TaskManger - Cooperative Multitasking System for Arduino</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">TaskManager<span id="projectnumber">&#160;2.0</span>
   </div>
   <div id="projectbrief">A Task Manager for Arduinos</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.4 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">TaskManger - Cooperative Multitasking System for Arduino </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="Overview"></a>
Overview</h1>
<p ><a class="el" href="class_task_manager.html" title="A cooperative multitasking manager.">TaskManager</a> is a cooperative task manager for the Arduino family of processors. It replaces the single user <code>loop()</code> routine with an environment in which the user can write many independent <code>loop()</code> -style routines. These user routines are run in a round-robin manner. In addition, routines can </p><ul>
<li>Delay &ndash; suspending their operation for a specified period while allowing other routines to make use of the time </li>
<li>Signal &ndash; suspend action until they receive a signal, or send a signal allowing a different task to resume </li>
<li>Message &ndash; suspend action until a message has been received, or send messages to different tasks to pass them information.</li>
</ul>
<h1><a class="anchor" id="News"></a>
News</h1>
<p >2022/05/31: Release 2.0: Merging Atmel and ESP32 branches. <br  />
 <br  />
ESP32 will include multi-node (mesh) routines to send/receive messages between nodes. Atmel systems will need to use TaskManagerRF version 2.0 to support this functionality. 2015/11/13: Release 1.0: Initial full release. <br  />
More code cleanup, improved documentation. Added routines so tasks could ID where messages/signals came from. may be a while until they are...</p>
<h1><a class="anchor" id="Summary"></a>
Summary</h1>
<p ><a class="el" href="class_task_manager.html" title="A cooperative multitasking manager.">TaskManager</a> is a cooperative multitasking task-swapper. It allows the developer to create many independent tasks, which are called in a round-robin manner. <br  />
<a class="el" href="class_task_manager.html" title="A cooperative multitasking manager.">TaskManager</a> offers the following: </p><ul>
<li>Any number of tasks. </li>
<li>Extends the Arduino "setup/loop" paradigm &ndash; the programmer creates several "loop" routines (tasks) instead of one. So programming is simple and straightforward. </li>
<li>Tasks can communicate through signals or messages. A signal is an information-free "poke" sent to whatever task is waiting for the poke. A message has information (string or data), and is passed to a particular task. </li>
<li><a class="el" href="class_task_manager.html" title="A cooperative multitasking manager.">TaskManager</a> programs can use RF24 2.4GHz radios to communicate between nodes. So tasks running on different nodes can communicate through signals and messages in the same manner as if they were on the same node.</li>
</ul>
<h1><a class="anchor" id="Example"></a>
Example</h1>
<p >The following is a <a class="el" href="class_task_manager.html" title="A cooperative multitasking manager.">TaskManager</a> program. </p><div class="fragment"><div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Blink two LEDs at different rates</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;SPI.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;RF24.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;TaskManager.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#define LED_1_PORT  2</span></div>
<div class="line"><span class="keywordtype">bool</span> led_1_state;</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#define LED_2_PORT  3</span></div>
<div class="line"><span class="keywordtype">bool</span> led_2_state;</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> setup() {</div>
<div class="line">  pinMode(LED_1_PORT, OUTPUT);</div>
<div class="line">  digitalWrite(LED_1_PORT, LOW);</div>
<div class="line">  led_1_state = LOW;</div>
<div class="line"> </div>
<div class="line">  pinMode(LED_2_PORT, OUTPUT);</div>
<div class="line">  digitalWrite(LED_2_PORT, LOW);</div>
<div class="line">  led_2_state = LOW;</div>
<div class="line"> </div>
<div class="line">  TaskMgr.<a class="code hl_function" href="group___task_manager.html#ga3b61b260f5ddd9676f7a6899da40ad9e">add</a>(1, loop_led_1);</div>
<div class="line">  TaskMgr.<a class="code hl_function" href="group___task_manager.html#ga3b61b260f5ddd9676f7a6899da40ad9e">add</a>(2, loop_led_2);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> loop_led_1() {</div>
<div class="line">    led_1_state = (led_1_state==LOW) ? HIGH : LOW;</div>
<div class="line">    digitalWrite(LED_1_PORT, led_1_state);</div>
<div class="line">    TaskMgr.<a class="code hl_function" href="group___task_manager.html#ga2123fa0af84c3a1373b9437e2157e872">yieldDelay</a>(500);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> loop_led_2() {</div>
<div class="line">    led_2_state = (led_2_state==LOW) ? HIGH : LOW;</div>
<div class="line">    digitalWrite(LED_2_PORT, led_2_state);</div>
<div class="line">    TaskMgr.<a class="code hl_function" href="group___task_manager.html#ga2123fa0af84c3a1373b9437e2157e872">yieldDelay</a>(100);</div>
<div class="line">}</div>
<div class="ttc" id="agroup___task_manager_html_ga2123fa0af84c3a1373b9437e2157e872"><div class="ttname"><a href="group___task_manager.html#ga2123fa0af84c3a1373b9437e2157e872">TaskManager::yieldDelay</a></div><div class="ttdeci">void yieldDelay(unsigned long ms)</div><div class="ttdoc">Exit from the task manager and do not restart this task until after a specified period.</div><div class="ttdef"><b>Definition:</b> TaskManager.cpp:218</div></div>
<div class="ttc" id="agroup___task_manager_html_ga3b61b260f5ddd9676f7a6899da40ad9e"><div class="ttname"><a href="group___task_manager.html#ga3b61b260f5ddd9676f7a6899da40ad9e">TaskManager::add</a></div><div class="ttdeci">void add(tm_taskId_t taskId, void(*fn)())</div><div class="ttdoc">Add a simple task.</div><div class="ttdef"><b>Definition:</b> TaskManager.cpp:172</div></div>
</div><!-- fragment --><p >Note the following; this is all that is needed for <a class="el" href="class_task_manager.html" title="A cooperative multitasking manager.">TaskManager</a>: </p><ul>
<li>You need to '#include &lt;<a class="el" href="_task_manager_8h_source.html">TaskManager.h</a>&gt;'. </li>
<li>There is no 'void loop()'. Instead, you write a routine for each independent task as if it were its own 'loop()'. </li>
<li>You tell 'TaskMgr' about your routines through the 'void TaskManager::add(byte
    taskId, void (*) task);' method. This is shown in the two calls to 'TaskMgr.add(...);'. </li>
<li>You do not use 'delay();'. Never use 'delay();'. 'delay();' delays all things; nothing will run. Instead use <a class="el" href="group___task_manager.html#ga2123fa0af84c3a1373b9437e2157e872" title="Exit from the task manager and do not restart this task until after a specified period.">TaskManager::yieldDelay()</a>'. 'yieldDelay()' will return from the current routine and guarantee it won't be restarted for the specified time. However, other routines will be allowed to run during this time.</li>
</ul>
<h1><a class="anchor" id="future"></a>
Future Work</h1>
<p >Here are the upcoming/future plans for <a class="el" href="class_task_manager.html" title="A cooperative multitasking manager.">TaskManager</a>. Some are short term, some are longer term. </p><ul>
<li>SPI investigation/certification. Running RF in a multi-SPI environment is "fraught with peril". The SPI routines <code>beginTransaction()</code> and <code>endTransaction()</code> allow different SPI devices to share the MOSI/MISO interface even if they use different serial settings. However, most SPI libraries do not use currently use these routines. (Note that the RF library recommended for <a class="el" href="class_task_manager.html" title="A cooperative multitasking manager.">TaskManager</a> does.) We need to investigate the different SPI libraries and identify the transaction-safety of each. </li>
<li>Suspend, resume, and kill. These routines haven't been fully tested. </li>
</ul>
</div></div><!-- PageDoc -->
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Jul 5 2022 13:15:22 for TaskManager by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.4
</small></address>
</body>
</html>
